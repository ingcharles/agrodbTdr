<?php 	session_start();	require_once '../../clases/Conexion.php';	require_once '../../clases/ControladorCatalogos.php';	require_once '../../clases/ControladorServiciosLinea.php';		$conexion = new Conexion();;	$cc = new ControladorCatalogos();	$csl = new ControladorServiciosLinea();	$idRutaTransporte=$_POST['id'];	$res = $csl->buscarGARutasTransporte($conexion, '', '', '',null,1,$idRutaTransporte);	$ruta = pg_fetch_assoc($res);	$qOficina = $cc->obtenerLocalizacionHijo($conexion,  'SITIOS', 'CANTONES', $ruta['id_canton']);	while ($fila = pg_fetch_assoc($qOficina)){
		$oficina[] = array(codigo=>$fila['id_localizacion'],nombre=>$fila['nombre'],categoria=>$fila['categoria'],padre=>$fila['id_localizacion_padre'],latitud=>$fila['latitud'],longitud=>$fila['longitud'],zona=>$fila['zona']);
	}	$qCantones = $cc->obtenerLocalizacionHijo($conexion,  'CANTONES', 'PROVINCIAS', $ruta['id_provincia']);	while ($fila = pg_fetch_assoc($qCantones)){
		$cantones[] = array(codigo=>$fila['id_localizacion'],nombre=>$fila['nombre'],categoria=>$fila['categoria'],padre=>$fila['id_localizacion_padre'],latitud=>$fila['latitud'],longitud=>$fila['longitud'],zona=>$fila['zona']);
	}		$arrayRecorrido=array();	$qDetalleRutaTransporte=$csl->buscarDetalleRutaTransporte($conexion, $idRutaTransporte);
	while($fila=pg_fetch_assoc($qDetalleRutaTransporte)){
		$arrayRecorrido[]=array(lat=>floatval($fila['latitud']) ,lng=>floatval($fila['longitud']),dir=>$fila['referencia_parada'],hor=>$fila['hora_aproximada'],ord=>$fila['orden'],recorrido=>$fila['recorrido'],idDetalle=>$fila['id_detalle_rutas_transporte']);
	}		$sector = array('Aloag','Machachi','Norte','Sur','Valle de los Chillos','Valle de Tumbaco');
	for ($i=0; $i<sizeof($sector); $i++)
		$listaSectores[]= array(sector=>$sector[$i]);	?><!DOCTYPE html><html><head><meta charset="utf-8"></head><body>	<header>		<h1>Modificar Rutas de Transporte Institucional</h1>	</header>	<form id="nuevoRecorridosInstitucionales" data-rutaAplicacion="serviciosLinea" data-opcion="actualizarGARecorridosInstitucionales">		<input type="hidden" id="opcion" name="opcion" /> 		<input type="hidden" id="nombreProvincia" name="nombreProvincia" />		<input type="hidden" id="nombreCanton" name="nombreCanton" />		<input type="hidden" id="nombreOficina" name="nombreOficina" /> 		<input type="hidden" id="idRutaTransporte" name="idRutaTransporte" value="<?php echo $idRutaTransporte;?>" /> 		<input type="hidden" id="identificadorResponsable" name="identificadorResponsable" value="<?php echo $_SESSION['usuario'];?>" />		<div id="estado"></div>		<fieldset>			<legend>Transporte Institucional</legend>					<div data-linea="1">					<label>Nombre ruta:</label> 					<input type="text" id="nombreRuta" name="nombreRuta" value="<?php echo $ruta['nombre_ruta'];?>"  maxlength="512" data-er="^[A-Za-zñÑÁáÉéÍíÓóÚúÜü ]+$" disabled="disabled"/> 				</div>				<div data-linea="2" >					<label>Provincia: </label>					<select id="provincia" name="provincia"  disabled="disabled">					<option value="">Seleccione...</option>					<?php 						$provincias = $cc->listarSitiosLocalizacion($conexion,'PROVINCIAS');						foreach ($provincias as $provincia)							echo '<option value="'.$provincia['codigo'].'">' . $provincia['nombre'] . '</option>';					?>					</select>				</div>					<div data-linea="2" id="resultadoCantones">					<label>Cantón: </label> 					<select id="canton" name="canton"  disabled="disabled">						<option value="">Seleccione...</option>					</select>				</div>				<div data-linea="3" id="resultadoOficinas">					<label>Oficina: </label> 					<select id="oficina" name="oficina"  disabled="disabled">						<option value="">Seleccione...</option>					</select>				</div>				<div data-linea="3">					<label>Sector:</label> 					<select name="sector" id="sector"  disabled="disabled" >						<option value="" >Seleccione...</option>						<?php							$sector = array('Aloag','Machachi','Norte','Sur','Valle de los Chillos','Valle de Tumbaco');																	for ($i=0; $i<sizeof($sector); $i++)								echo '<option value="'.$sector[$i].'">'. $sector[$i] . '</option>';						?>					</select>				</div>				<div data-linea="4">					<label>Conductor:</label> 					<input type="text" id="conductor" name="conductor" value="<?php echo $ruta['conductor'];?>" maxlength="256"  disabled="disabled" data-er="^[A-Za-zñÑÁáÉéÍíÓóÚúÜü ]+$"  /> 				</div>				<div data-linea="4">					<label>Teléfono:</label> 					<input type="text" id="telefono" name="telefono" value="<?php echo $ruta['telefono'];?>"  maxlength="16" disabled="disabled" data-er="^\([0-9]{2}\) [0-9]{4}-[0-9]{4}" data-inputmask="'mask': '(99) 9999-9999'" /> 				</div>				<div data-linea="5">					<label>Administrador Grupo:</label> 						<input type="text" id="administradorGrupo" name="administradorGrupo" value="<?php echo $ruta['administrador_grupo'];?>" disabled="disabled"  maxlength="256" data-er="^[A-Za-zñÑÁáÉéÍíÓóÚúÜü ]*$" /> 				</div>				<div data-linea="5">					<label>Teléfono:</label> 						<input type="text" id="telefonoAdministrador" name="telefonoAdministrador" value="<?php echo $ruta['telefono_administrador'];?>" disabled="disabled"  maxlength="16"  data-inputmask="'mask': '(99) 9999-9999'"  /> 				</div>				<div data-linea="6">					<label>Capacidad:</label> 						<input type="text" id="capacidadVehiculo" name="capacidadVehiculo" value="<?php echo $ruta['capacidad_vehiculo'];?>" disabled="disabled"  maxlength="3" onKeyPress='validaSoloNumeros()' data-er="^[0-9]+$" /> 				</div>				<div data-linea="6">					<label>Número Pasajeros:</label> 						<input type="text" id="numeroPasajeros" name="numeroPasajeros" value="<?php echo $ruta['numero_pasajeros'];?>" disabled="disabled"  maxlength="3" onKeyPress='validaSoloNumeros()' data-er="^[0-9]+$" /> 				</div>				<div data-linea="7">					<label>Placa Vehículo:</label> 						<input type="text" id="placaVehiculo" name="placaVehiculo" value="<?php echo $ruta['placa_vehiculo'];?>" disabled="disabled"  maxlength="8" data-inputmask="'mask': 'aaa-9999'" data-er="^([A-Za-z]{3}-\d{4})$"/> 				</div>				<div data-linea="8">					<label>Descripción Vehículo:</label> 						<input type="text" id="descripcionVehiculo" name="descripcionVehiculo" value="<?php echo $ruta['descripcion_vehiculo'];?>" disabled="disabled"  maxlength="512" data-er="^[A-Za-z0-9ñÑÁáÉéÍíÓóÚúÜü ,]+$" /> 				</div>				<div data-linea="9">					<label>Estado:</label> 					<select id="estadoRuta" name="estadoRuta" disabled>						<option value="activo">Activo</option>						<option value="inactivo">Inactivo</option>					</select>				</div>				<p>					<button id="modificar" type="button" class="editar">Modificar</button>					<button id="actualizar" type="submit" class="guardar" disabled="disabled">Guardar</button>				</p>		</fieldset>	</form>		<form id="nuevoDetalleTransporte" data-rutaAplicacion="serviciosLinea" data-opcion="guardarGARecorridosDetalle" >		<input type="hidden" id="idRutaTransporte" name="idRutaTransporte" value="<?php echo $idRutaTransporte;?>">		<input type="hidden" id="identificadorResponsable" name="identificadorResponsable" value="<?php echo $_SESSION['usuario'];?>" />		<input type="hidden" id="contador" name="contador" value="0" />		<input type="hidden" id="posicion" name="posicion" value="0" />		<fieldset>			<legend>Recorrido</legend>			<div id="map" data-linea="1"></div>			<hr/>			<div data-linea="2">				<label>Latitud:</label> 				<input type="text" id="latitud" name="latitud"  maxlength="12" readOnly /> 			</div>			<div data-linea="2">				<label>Longitud:</label> 				<input type="text" id="longitud" name="longitud"  maxlength="12" readOnly /> 			</div>			<div data-linea="3">				<label>Recorrido:</label> 				<select id="recorrido" name="recorrido" >					<option value="">Seleccione...</option>					<option value="Mañana">Mañana</option>					<option value="Tarde">Tarde</option>				</select>			</div>			<div data-linea="3">				<label>Hora aproximada:</label> 				<input type="text" id="horaAproximada" name="horaAproximada" data-inputmask="'mask': '99:99'" /> 			</div>			<div data-linea="4">				<label>Dirección:</label> 				<input type="text" id="direccion" name="direccion"  maxlength="256" /> 			</div>				<div data-linea="5">				<button type="submit" id="agregarDetalleRecorrido" class="mas" onclick="obtenerContador()">Agregar</button>			</div>		</fieldset>	</form>			<fieldset>		<legend>Rutas del Recorrido</legend>		<table id="camposDetalleRutas" style="width:100%"  class="tablaMatriz">		<thead>		<tr>			<th>#</th>			<th>Latitud</th>			<th>Longitud</th>			<th>Dirección</th>			<th>Recorrido</th>			<th>Hora Aproximada</th>			<th>Subir</th>			<th>Bajar</th>			<th>Eliminar</th>			</tr>		</thead>		<?php 			$contador=1;			foreach ($arrayRecorrido as $recorrido){				echo $csl->imprimirLineaDetalleRutasTransporte($recorrido['idDetalle'],$recorrido['lat'], $recorrido['lng'],$recorrido['dir'],$recorrido['hor'],$recorrido['recorrido'],$contador++);
			}
		?>		</table>	</fieldset>		</body><script type="text/javascript">		var array_canton= <?php echo json_encode($cantones); ?>;var array_oficina= <?php echo json_encode($oficina); ?>;var rutasRecorrido= <?php echo json_encode($arrayRecorrido); ?>; var posicionInicial=rutasRecorrido[0]; if(rutasRecorrido=="")	var posicionInicial={lat: -0.19036973, lng: -78.48820075};	$(document).ready(function(){		distribuirLineas();		construirValidador();		cargarValorDefecto("provincia","<?php echo $ruta['id_provincia'];?>");		cargarValorDefecto("estadoRuta","<?php echo $ruta['estado'];?>");		scanton ='';		scanton = '<option value="">Seleccione...</option>';	    for(var i=0;i<array_canton.length;i++){		    if ($("#provincia").val()==array_canton[i]['padre'])		    	scanton += '<option value="'+array_canton[i]['codigo']+'">'+array_canton[i]['nombre']+'</option>';	   	}	    $('#canton').html(scanton);	    cargarValorDefecto("canton","<?php echo $ruta['id_canton'];?>");	  		soficina ='';		soficina = '<option value="">Seleccione...</option>';	    for(var i=0;i<array_oficina.length;i++){		    if ($("#canton").val()==array_oficina[i]['padre'])		    	soficina += '<option value="'+array_oficina[i]['codigo']+'">'+array_oficina[i]['nombre']+'</option>';	    }		$('#oficina').html(soficina);		cargarValorDefecto("oficina","<?php echo $ruta['id_oficina'];?>");		cargarValorDefecto("sector","<?php echo $ruta['sector'];?>");		cargarMapa(rutasRecorrido,posicionInicial);		actualizarBotonesOrdenamiento();	});	acciones("#nuevoDetalleTransporte","#camposDetalleRutas",new exitoBajarr(),new exitoSubirr(),new exitoIngresoo(),new exitoBorradoo(),null, new validarInputs() );	function obtenerContador() {		var numItems=$("#camposDetalleRutas tbody  tr:last-child .contador").html();		if(isNaN(numItems))			numItems=0;		$("#contador").val(parseInt(numItems)+1);	}	$("#camposDetalleRutas").on("click","tbody  tr td form",function(event){		var cont=$(this).parent().parent().find(".contador").html();		if(isNaN(cont))			cont=1;		$("#posicion").val(cont);	});		function exitoIngresoo(){		this.ejecutar = function(msg){			mostrarMensaje("Nuevo registro agregado","EXITO");			var fila = msg.mensaje;			$("#camposDetalleRutas").append(fila);				$("#nuevoDetalleTransporte" + " fieldset input:not(:hidden,[data-resetear='no'])").val('');			$("#nuevoDetalleTransporte fieldset select").val('');			var datos=obtenerCordenadas();			cargarMapa(datos,datos[datos.length-1]);		};	}	function exitoContador(){		var seccion="#camposDetalleRutas";		var contador=".contador";		var con=1;		$(seccion + " tbody tr "+contador).each(function() {			$(this).html(con++);		});	}	function exitoBorradoo(){		this.ejecutar = function(msg){			var seccion="#camposDetalleRutas";		var registro = " #R";        if(typeof msg.registro != "undefined") {            registro = " " + msg.registro;        }		$(seccion + registro + msg.mensaje).fadeOut("fast",function(){		        $(this).remove();		        exitoContador();		        var datos=obtenerCordenadas();				cargarMapa(datos,datos[datos.length-1]);		 });			mostrarMensaje("Elemento borrado","EXITO");		};	}	function exitoSubirr(){		this.ejecutar = function(msg){			var seccion="#camposDetalleRutas";			var fila = $(seccion + " #R" + msg.mensaje);			$(seccion + " #R" + msg.mensaje).clone(true).insertAfter($(seccion + " #R" + msg.mensaje).next());			$(fila).remove();			exitoContador();			var datos=obtenerCordenadas();			var posicion=parseInt($("#posicion").val());			cargarMapa(datos,datos[posicion-1]);			mostrarMensaje("Elementos reordenados","EXITO");			actualizarBotonesOrdenamiento();		};	}	function exitoBajarr(){		this.ejecutar = function(msg){			var seccion="#camposDetalleRutas";			var fila = $(seccion + " #R" + msg.mensaje);			$(seccion + " #R" + msg.mensaje).clone(true).insertBefore($(seccion + " #R" + msg.mensaje).prev());			$(fila).remove();			exitoContador();			var datos=obtenerCordenadas();			var posicion=parseInt($("#posicion").val());			cargarMapa(datos,datos[posicion-1]);			mostrarMensaje("Elementos reordenados","EXITO");			actualizarBotonesOrdenamiento();		};	}		function obtenerCordenadas(){		var ruta=$("#idRutaTransporte").val();		var pinNumber = $.ajax({	  		type:'POST',	  		url: "aplicaciones/serviciosLinea/obtenerCoordenadas.php",	  		data: { ruta: ruta },	  	    async: false		}).responseText;		var a=$.parseJSON( pinNumber );		return a;	}	function validarInputs() {		var msj;	    this.ejecutar = function () {	        var error = false;	        $(".alertaCombo").removeClass("alertaCombo");	        $("#estado").html("");			if ($("#direccion").val()==""){			   error = true;		       $("#direccion").addClass("alertaCombo");		       msj='Por favor ingrese la dirección';			}						if (!esCampoValido("#horaAproximada")){			   error = true;		       $("#horaAproximada").addClass("alertaCombo");		       msj='Por favor revise el formato de la hora aproximada';			}			if ($("#horaAproximada").val()==""){			   error = true;		       $("#horaAproximada").addClass("alertaCombo");		       msj='Por favor ingrese la hora aproximada de la ruta';			}			if ($("#recorrido").val()==""){				   error = true;				   $("#recorrido").addClass("alertaCombo");				   msj='Por favor seleccione el recorrido';				}						if ($("#longitud").val()==""){			   error = true;		       $("#longitud").addClass("alertaCombo");		        msj='Por favor ingrese la longitud';			}			if ($("#latitud").val()==""){			   error = true;		       $("#latitud").addClass("alertaCombo");		        msj='Por favor ingrese la latitud';			}			return !error;	        	    };	    this.mensajeError = function () {	    	mostrarMensaje(msj, "FALLO");	    }	    	}		$("#recorrido").change(function(event){		if($("#recorrido").val()!=''){			if($("#recorrido").val()=='Mañana'){				$("#horaAproximada").attr('data-er','^(0[0-9]|1?[0-1]):[0-5]?[0-9]$');			}else{				$("#horaAproximada").attr('data-er','^(1?[2-9]|2[0-3]):[0-5]?[0-9]$');							}		}	});		$("#provincia").change(function(event){		if($("#provincia").val()!=0){			$("#nombreProvincia").val($('#provincia option:selected').text());			$('#nuevoRecorridosInstitucionales').attr('data-destino','resultadoCantones');			$('#nuevoRecorridosInstitucionales').attr('data-opcion','accionesServiciosLinea');	 		    $('#opcion').val('listaCantones');					abrir($("#nuevoRecorridosInstitucionales"),event,false); 			$("#provincia").removeClass("alertaCombo");		}	});	$("#canton").change(function(event){		if($("#canton").val()!=0){			$('#nuevoRecorridosInstitucionales').attr('data-destino','resultadoOficinas');			$('#nuevoRecorridosInstitucionales').attr('data-opcion','accionesServiciosLinea');		    $('#opcion').val('listaOficinas');				    event.stopImmediatePropagation();			abrir($("#nuevoRecorridosInstitucionales"),event,false); 		}	});	$("#oficina").change(function(event){		if($("#oficina").val()!=0){			if($("#oficina option:selected").text()=='Oficina Planta Central' || $("#oficina option:selected").text()=='Laboratorios Tumbaco'){				var listaSectores = <?php echo json_encode($listaSectores);?>;				sListaSector = '<option value="">Seleccione...</option>';				for(var i=0; i<listaSectores.length; i++){					sListaSector += '<option value="'+listaSectores[i]['sector']+'">'+listaSectores[i]['sector']+'</option>';					 $('#sector').html(sListaSector);				}			}else{				$('#sector').html('<option value="">Seleccione...</option><option value="Norte">Norte</option><option value="Sur">Sur</option>');			}		}	});		$("#modificar").click(function(){		$("#nuevoRecorridosInstitucionales input").removeAttr("disabled");		$("#nuevoRecorridosInstitucionales select").removeAttr("disabled");		$("#actualizar").removeAttr("disabled");		$(this).attr("disabled",true);	});	function validaSoloNumeros() {		if ((event.keyCode < 48) || (event.keyCode > 57))		event.returnValue = false;	}		$("#nuevoRecorridosInstitucionales").submit(function(event){		event.preventDefault();		$(".alertaCombo").removeClass("alertaCombo");		var error = false;		if(!$.trim($("#estadoRuta").val())){			error = true;			$("#estadoRuta").addClass("alertaCombo");			$("#estado").html('Por favor seleccione el estado').addClass("alerta");			}		if(!esCampoValido("#descripcionVehiculo")){			error = true;			$("#descripcionVehiculo").addClass("alertaCombo");			$("#estado").html('Por favor revise el formato de la descripción del vehículo').addClass("alerta");		}				if(!$.trim($("#descripcionVehiculo").val())){			error = true;			$("#descripcionVehiculo").addClass("alertaCombo");			$("#estado").html('Por favor ingrese la descripción del vehículo').addClass("alerta");			}		if(!esCampoValido("#placaVehiculo")){			error = true;			$("#placaVehiculo").addClass("alertaCombo");			$("#estado").html('Por favor revise el formato de la placa del vehículo').addClass("alerta");			}			if(!$.trim($("#placaVehiculo").val())){			error = true;			$("#placaVehiculo").addClass("alertaCombo");			$("#estado").html('Por favor ingrese la placa del vehículo').addClass("alerta");			}				if(!$.trim($("#numeroPasajeros").val())){			error = true;			$("#numeroPasajeros").addClass("alertaCombo");			$("#estado").html('Por favor ingrese el número de pasajeros del vehículo').addClass("alerta");			}				if(!$.trim($("#capacidadVehiculo").val())){			error = true;			$("#capacidadVehiculo").addClass("alertaCombo");			$("#estado").html('Por favor ingrese la capacidad del vehículo').addClass("alerta");			}		if (!esCampoValido("#administradorGrupo")){			error = true;		    $("#administradorGrupo").addClass("alertaCombo");		    $("#estado").html('Por favor revise el formato del nombre del administrador del grupo del whatsapp').addClass("alerta");		}				if (!esCampoValido("#telefono")){			error = true;		    $("#telefono").addClass("alertaCombo");		    $("#estado").html('Por favor revise el formato del teléfono del conductor').addClass("alerta");		}				if(!$.trim($("#telefono").val())){			error = true;			$("#telefono").addClass("alertaCombo");			$("#estado").html('Por favor ingrese el número de teléfono').addClass("alerta");		}		if (!esCampoValido("#conductor")){			error = true;		    $("#conductor").addClass("alertaCombo");		    $("#estado").html('Por favor revise el formato del nombre del conductor').addClass("alerta");		}				if(!$.trim($("#conductor").val())){			error = true;			$("#conductor").addClass("alertaCombo");			 $("#estado").html('Por favor ingrese nombre del conductor').addClass("alerta");		}		if(!$.trim($("#sector").val())){			error = true;			$("#sector").addClass("alertaCombo");			$("#estado").html('Por favor seleccione el sector').addClass("alerta");		}					if(!$.trim($("#oficina").val())){			error = true;			$("#oficina").addClass("alertaCombo");			$("#estado").html('Por favor seleccione la oficina').addClass("alerta");		}					if(!$.trim($("#canton").val())){			error = true;			$("#canton").addClass("alertaCombo");			$("#estado").html('Por favor seleccione el cantón').addClass("alerta");		}		if(!$.trim($("#provincia").val())){			error = true;			$("#provincia").addClass("alertaCombo");			$("#estado").html('Por favor seleccione la provincia').addClass("alerta");		}		if(!esCampoValido("#nombreRuta")){			error = true;			$("#nombreRuta").addClass("alertaCombo");			$("#estado").html('Por favor verifique el formato del nombre de la ruta').addClass("alerta");		}				if(!$.trim($("#nombreRuta").val())){			error = true;			$("#nombreRuta").addClass("alertaCombo");			$("#estado").html('Por favor ingrese el nombre de la ruta').addClass("alerta");		}		if (!error){			$("#modificar").attr('disabled',false);			$("#nombreProvincia").val($("#provincia option:selected").text());			$("#nombreCanton").val($("#canton option:selected").text());			$("#nombreOficina").val($("#oficina option:selected").text());			ejecutarJson("#nuevoRecorridosInstitucionales");			$("#actualizar").attr('disabled','disabled');		}	});		function cargarMapa (rutasRecorridos,posicion) {		rutasRecorrido=rutasRecorridos;        map = new google.maps.Map(document.getElementById('map'), {        	 center: posicion,            zoom: 14        });           	  	var  marcadores = [];    	  	      	function llamada(map){          	      		var lat=$("#latitud").val();      		var lng=$("#longitud").val();      		var infoWindow = new google.maps.InfoWindow;      		var  marcadorUno = [];      			      	var pinNumber = $.ajax({	      		type:'POST',url: "aplicaciones/serviciosLinea/obtenerDireccion.php",	      		    data: { lat: lat, lng: lng },	      	    async: false	      	}).responseText;	      	$("#direccion").val(pinNumber);	      		      	marcador = new google.maps.Marker({	      		position: new google.maps.LatLng(lat, lng),	      	    map: map,    	      	});      		marcadores.push(marcador);      		marcadorUno.push(marcador);	      	 var html = '<div id="content">'+	         '<div id="bodyContent">'+	         '<p><b>Latitud: </b>'+lat+	         '<br><b>Longitud: </b>'+lng+	         '<br><b>Dirección: </b>'+pinNumber+	         '</p></div></div>';               	    infoWindow.setContent(html);       	   	infoWindow.open(map, marcador);               		google.maps.event.addListener(marcador, "click", function (event) {       	         for (var i = 0; i < marcadorUno.length; i++) marcadorUno[i].setMap(null); 	            	 	      });   	      	}        google.maps.event.addListener(map,'click',function(event) {        	for (var i = 0; i < marcadores.length; i++)	marcadores[i].setMap(null);        	$("#latitud").val(event.latLng.lat().toFixed(8));        	$("#longitud").val(event.latLng.lng().toFixed(8));        	llamada(map);        });                var manana = new Array();        var tarde = new Array();    	var punto=0;		var puntoManana=0;		var puntoTarde=0;       	for(var i=0; i<rutasRecorrido.length; i++){    		latlon = new google.maps.LatLng(rutasRecorrido[i].lat, rutasRecorrido[i].lng);    		if(rutasRecorrido[i].recorrido=='Mañana'){    			manana.push(rutasRecorrido[i]);          		puntoManana=puntoManana+1;          		punto=puntoManana;            }else{            	tarde.push(rutasRecorrido[i]);          		puntoTarde=puntoTarde+1;          		punto=puntoTarde;            }                        marker = new google.maps.Marker({            	map: map,            	position: latlon,                hora: '<b>Punto '+punto+'</b><br><b>Hora: </b>'+rutasRecorrido[i].hor+'<br><b>Dirección: </b>'+rutasRecorrido[i].dir,                title:rutasRecorrido[i].dir,                label:{                	text: punto.toString(),                    color: 'white',                    fontSize: "16px",                    fontWeight: "bold"                }    		});            marker.info = new google.maps.InfoWindow();            google.maps.event.addListener(marker, 'click', function() {            	marker.info.setContent(this.hora);                marker.info.open(map, this);    		});            marker.setMap(map);                	}       	var flightPath = new google.maps.Polyline({            path: manana,            geodesic: true,            strokeColor: '#8416FA',            strokeOpacity: 0.5,            strokeWeight: 5        });      	flightPath.setMap(map);      	var flightPathh = new google.maps.Polyline({            path: tarde,            geodesic: true,            strokeColor: '#06c1d6',            strokeOpacity: 0.5,            strokeWeight: 5        });      	flightPathh.setMap(map);              		}</script></html>					